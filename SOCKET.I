;WSOCK Structures and Constants

WSADESCRIPTION_LEN equ 256
WSASYS_STATUS_LEN equ 128
IPPROTO_IP equ 0
IPPROTO_ICMP equ 1
IPPROTO_GGP equ 2
IPPROTO_TCP equ 6
IPPROTO_PUP equ 12
IPPROTO_UDP equ 17
IPPROTO_IDP equ 22
IPPROTO_ND equ 77
IPPROTO_RAW equ 255
IPPROTO_MAX equ 256
IOCPARM_MASK equ 7Fh
IOC_VOID equ 20000000h
IOC_OUT equ 40000000h
IOC_IN equ 80000000h
IOC_INOUT equ IOC_IN|IOC_OUT
FIONBIO equ 8004667Eh
FIONSYNC equ 8004667Dh
FIONREAD equ 4004667Fh
IPPORT_ECHO equ 7
IPPORT_DISCARD equ 9
IPPORT_SYSTAT equ 11
IPPORT_DAYTIME equ 13
IPPORT_NETSTAT equ 15
IPPORT_FTP equ 21
IPPORT_TELNET equ 23
IPPORT_SMTP equ 25
IPPORT_TIMESERVER equ 37
IPPORT_NAMESERVER equ 42
IPPORT_WHOIS equ 43
IPPORT_MTP equ 57
IPPORT_TFTP equ 69
IPPORT_RJE equ 77
IPPORT_FINGER equ 79
IPPORT_TTYLINK equ 87
IPPORT_SUPDUP equ 95
IPPORT_EXECSERVER equ 512
IPPORT_LOGINSERVER equ 513
IPPORT_CMDSERVER equ 514
IPPORT_EFSSERVER equ 520
IPPORT_BIFFUDP equ 512
IPPORT_WHOSERVER equ 513
IPPORT_ROUTESERVER equ 520
IPPORT_RESERVED equ 1024
IMPLINK_IP equ 155
IMPLINK_LOWEXPER equ 156
IMPLINK_HIGHEXPER equ 158
IN_CLASSA_NET equ 0FF000000h
IN_CLASSA_NSHIFT equ 24
IN_CLASSA_HOST equ 000FFFFFFh
IN_CLASSA_MAX equ 128
IN_CLASSB_NET equ 0FFFF0000h
IN_CLASSB_NSHIFT equ 16
IN_CLASSB_HOST equ 00000FFFFh
IN_CLASSB_MAX equ 65536
IN_CLASSC_NET equ 0FFFFFF00h
IN_CLASSC_NSHIFT equ 8
IN_CLASSC_HOST equ 0000000FFh
INADDR_ANY equ 000000000h
INADDR_LOOPBACK equ 07F000001h
INADDR_BROADCAST equ 0FFFFFFFFh
INADDR_NONE equ 0FFFFFFFFh
SOCK_STREAM equ 1
SOCK_DGRAM equ 2
SOCK_RAW equ 3
SOCK_RDM equ 4
SOCK_SEQPACKET equ 5
SO_DEBUG equ 00001h
SO_ACCEPTCONN equ 00002h
SO_REUSEADDR equ 00004h
SO_KEEPALIVE equ 00008h
SO_DONTROUTE equ 00010h
SO_BROADCAST equ 00020h
SO_USELOOPBACK equ 00040h
SO_LINGER equ 00080h
SO_OOBINLINE equ 00100h
SOL_SOCKET equ 0FFFFh
SO_DONTLINGER equ (-1-SO_LINGER)
SO_SNDBUF equ 01001h
SO_RCVBUF equ 01002h
SO_SNDLOWAT equ 01003h
SO_RCVLOWAT equ 01004h
SO_SNDTIMEO equ 01005h
SO_RCVTIMEO equ 01006h
SO_ERROR equ 01007h
SO_TYPE equ 01008h
TCP_NODELAY equ 00001h
AF_UNSPEC equ 0
AF_UNIX equ 1
AF_INET equ 2
AF_IMPLINK equ 3
AF_PUP equ 4
AF_CHAOS equ 5
AF_NS equ 6
AF_IPX equ 6
AF_ISO equ 7
AF_OSI equ AF_ISO
AF_ECMA equ 8
AF_DATAKIT equ 9
AF_CCITT equ 10
AF_SNA equ 11
AF_DECnet equ 12
AF_DLI equ 13
AF_LAT equ 14
AF_HYLINK equ 15
AF_APPLETALK equ 16
AF_NETBIOS equ 17
AF_MAX equ 18
PF_UNSPEC equ AF_UNSPEC
PF_UNIX equ AF_UNIX
PF_INET equ AF_INET
PF_IMPLINK equ AF_IMPLINK
PF_PUP equ AF_PUP
PF_CHAOS equ AF_CHAOS
PF_NS equ AF_NS
PF_IPX equ AF_IPX
PF_ISO equ AF_ISO
PF_OSI equ AF_OSI
PF_ECMA equ AF_ECMA
PF_DATAKIT equ AF_DATAKIT
PF_CCITT equ AF_CCITT
PF_SNA equ AF_SNA
PF_DECnet equ AF_DECnet
PF_DLI equ AF_DLI
PF_LAT equ AF_LAT
PF_HYLINK equ AF_HYLINK
PF_APPLETALK equ AF_APPLETALK
PF_MAX equ AF_MAX
SOMAXCONN equ 5
MSG_OOB equ 01h
MSG_PEEK equ 02h
MSG_DONTROUTE equ 04h
MSG_MAXIOVLEN equ 16
MAXGETHOSTSTRUCT equ 1024
FD_READ equ 001h
FD_WRITE equ 002h
FD_OOB equ 004h
FD_ACCEPT equ 008h
FD_CONNECT equ 010h
FD_CLOSE equ 020h
WSABASEERR equ 10000
WSAEINTR equ WSABASEERR+4
WSAEBADF equ WSABASEERR+9
WSAEACCES equ WSABASEERR+13
WSAEFAULT equ WSABASEERR+14
WSAEINVAL equ WSABASEERR+22
WSAEMFILE equ WSABASEERR+24
WSAEWOULDBLOCK equ WSABASEERR+35
WSAEINPROGRESS equ WSABASEERR+36
WSAEALREADY equ WSABASEERR+37
WSAENOTSOCK equ WSABASEERR+38
WSAEDESTADDRREQ equ WSABASEERR+39
WSAEMSGSIZE equ WSABASEERR+40
WSAEPROTOTYPE equ WSABASEERR+41
WSAENOPROTOOPT equ WSABASEERR+42
WSAEPROTONOSUPPORT equ WSABASEERR+43
WSAESOCKTNOSUPPORT equ WSABASEERR+44
WSAEOPNOTSUPP equ WSABASEERR+45
WSAEPFNOSUPPORT equ WSABASEERR+46
WSAEAFNOSUPPORT equ WSABASEERR+47
WSAEADDRINUSE equ WSABASEERR+48
WSAEADDRNOTAVAIL equ WSABASEERR+49
WSAENETDOWN equ WSABASEERR+50
WSAENETUNREACH equ WSABASEERR+51
WSAENETRESET equ WSABASEERR+52
WSAECONNABORTED equ WSABASEERR+53
WSAECONNRESET equ WSABASEERR+54
WSAENOBUFS equ WSABASEERR+55
WSAEISCONN equ WSABASEERR+56
WSAENOTCONN equ WSABASEERR+57
WSAESHUTDOWN equ WSABASEERR+58
WSAETOOMANYREFS equ WSABASEERR+59
WSAETIMEDOUT equ WSABASEERR+60
WSAECONNREFUSED equ WSABASEERR+61
WSAELOOP equ WSABASEERR+62
WSAENAMETOOLONG equ WSABASEERR+63
WSAEHOSTDOWN equ WSABASEERR+64
WSAEHOSTUNREACH equ WSABASEERR+65
WSAENOTEMPTY equ WSABASEERR+66
WSAEPROCLIM equ WSABASEERR+67
WSAEUSERS equ WSABASEERR+68
WSAEDQUOT equ WSABASEERR+69
WSAESTALE equ WSABASEERR+70
WSAEREMOTE equ WSABASEERR+71
WSASYSNOTREADY equ WSABASEERR+91
WSAVERNOTSUPPORTED equ WSABASEERR+92
WSANOTINITIALISED equ WSABASEERR+93
WSAHOST_NOT_FOUND equ WSABASEERR+1001
HOST_NOT_FOUND equ WSAHOST_NOT_FOUND
WSATRY_AGAIN equ WSABASEERR+1002
TRY_AGAIN equ WSATRY_AGAIN
WSANO_RECOVERY equ WSABASEERR+1003
NO_RECOVERY equ WSANO_RECOVERY
WSANO_DATA equ WSABASEERR+1004
NO_DATA equ WSANO_DATA
WSANO_ADDRESS equ WSANO_DATA
NO_ADDRESS equ WSANO_ADDRESS
EWOULDBLOCK equ WSAEWOULDBLOCK
EINPROGRESS equ WSAEINPROGRESS
EALREADY equ WSAEALREADY
ENOTSOCK equ WSAENOTSOCK
EDESTADDRREQ equ WSAEDESTADDRREQ
EMSGSIZE equ WSAEMSGSIZE
EPROTOTYPE equ WSAEPROTOTYPE
ENOPROTOOPT equ WSAENOPROTOOPT
EPROTONOSUPPORT equ WSAEPROTONOSUPPORT
ESOCKTNOSUPPORT equ WSAESOCKTNOSUPPORT
EOPNOTSUPP equ WSAEOPNOTSUPP
EPFNOSUPPORT equ WSAEPFNOSUPPORT
EAFNOSUPPORT equ WSAEAFNOSUPPORT
EADDRINUSE equ WSAEADDRINUSE
EADDRNOTAVAIL equ WSAEADDRNOTAVAIL
ENETDOWN equ WSAENETDOWN
ENETUNREACH equ WSAENETUNREACH
ENETRESET equ WSAENETRESET
ECONNABORTED equ WSAECONNABORTED
ECONNRESET equ WSAECONNRESET
ENOBUFS equ WSAENOBUFS
EISCONN equ WSAEISCONN
ENOTCONN equ WSAENOTCONN
ESHUTDOWN equ WSAESHUTDOWN
ETOOMANYREFS equ WSAETOOMANYREFS
ETIMEDOUT equ WSAETIMEDOUT
ECONNREFUSED equ WSAECONNREFUSED
ELOOP equ WSAELOOP
ENAMETOOLONG equ WSAENAMETOOLONG
EHOSTDOWN equ WSAEHOSTDOWN
EHOSTUNREACH equ WSAEHOSTUNREACH
ENOTEMPTY equ WSAENOTEMPTY
EPROCLIM equ WSAEPROCLIM
EUSERS equ WSAEUSERS
EDQUOT equ WSAEDQUOT
ESTALE equ WSAESTALE
EREMOTE equ WSAEREMOTE
FD_SETSIZE equ 64
INVALID_SOCKET equ (-1-0)
SOCKET_ERROR equ -1
SOCKET_BUFFER_SIZE equ 512
ICMP_ECHOREPLY equ 0
ICMP_ECHOREQ equ 8


fd_setstruc STRUC
       fd_count dd ?
       fd_array dd ?
fd_setstruc ENDS

timeval STRUC
       tv_sec  dd ?
       tv_usec dd ?
timeval ENDS

sockaddr_in STRUC
       sin_family dw ?
       sin_port   dw ?
       sin_addr   dd ?
       sin_zero   db 8 dup (?)
sockaddr_in ENDS

sockaddr STRUC
       sa_family dw ?
       sa_data   dw ?
sockaddr ENDS

WSAdata STRUC
       wVersion       dw ?
       wHighVersion   dw ?
       szDescription  db WSADESCRIPTION_LEN+1 dup (?)
       szSystemStatus db WSASYS_STATUS_LEN+1 dup (?)
       iMaxSockets    dw ?
       iMaxUdpDg      dw ?
       lpVendorInfo   dd ?
WSAdata ENDS

sockproto STRUC
       sp_family   dw ?
       sp_protocol dw ?
sockproto ENDS

linger STRUC
       l_onoff  dw ?
       l_linger dw ?
linger ENDS

hostentStru STRUC
       h_name  dd ?
       h_alias dd ?
       h_addr  dw ?
       h_len   dw ?
       h_list  dd ?
hostentStru ENDS

netent STRUC
       n_name     dd ?
       n_aliases  dd ?
       n_addrtype dw ?
       n_net      dd ?
netent ENDS

servent STRUC
       s_name    dd ?
       s_aliases dd ?
       s_port    dw ?
       s_proto   dd ?
servent ENDS

icmp_hdr STRUC
       icmp_type  db ?
       icmp_code  db ?
       icmp_cksum dw ?
       icmp_id    dw ?
       icmp_seq   dw ?
       icmp_data  db ?
icmp_hdr ENDS

ip_hdr STRUC
       ip_hlv   db ?
       ip_tos   db ?
       ip_len   dw ?
       ip_id    dw ?
       ip_off   dw ?
       ip_ttl   db ?
       ip_p     db ?
       ip_cksum dw ?
       ip_src   dd ?
       ip_dest  dd ?
ip_hdr ENDS

ICMP_OPTIONS STRUC
       Ttl         db ?
       Tos         db ?
       Flags       db ?
       OptionsSize db ?
       OptionsData dd ?
ICMP_OPTIONS ENDS

ICMP_ECHO_REPLY STRUC
       Address       dd ?
       Status        dd ?
       RoundTripTime dd ?
       DataSize      dw ?
       Reserved      dw ?
       DataPointer   dd ?
       Options       dd ?
       zData         db 250 dup (?)
ICMP_ECHO_REPLY ENDS
